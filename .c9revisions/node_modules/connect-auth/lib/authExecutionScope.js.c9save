{"ts":1350573236917,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"/*!\n * Copyright(c) 2010 Ciaran Jessup <ciaranj@gmai.com>\n * MIT Licensed\n */\nvar AuthExecutionScope= module.exports = function( authContext ) {\n  this.executionResult= { authenticated: false };\n  this.authContext= authContext;\n  this._trace= authContext.request.getAuthDetails().trace;\n  this._scope= authContext.scope;\n}\n\n/**\n * Utility method for providing tracing functionality within an autthenitcation strategy\n * Takes a 'message' to log out\n */\nAuthExecutionScope.prototype.trace= function( message ) { \n  var messagePrefix= \"\";\n  if( this.executionResult.currentStrategy ) {\n    messagePrefix= this.executionResult.currentStrategy + \": \";\n  }\n  this._trace( messagePrefix + message, this._scope, \"***\" )\n}\n\nAuthExecutionScope.prototype.fail= function(callback) { \n  this.trace( \"Failed\", \"***\" );\n  this.executionResult.authenticated= false;\n  callback();\n}\nAuthExecutionScope.prototype.redirect= function(response, url, callback) {\n  this.trace( \"Redirecting to: \"+ url, \"***\" );\n  response.writeHead(303, { 'Location': url });\n  response.end('');\n  this.executionResult.authenticated= undefined;\n  this._halt(callback);\n};\n\nAuthExecutionScope.prototype.success= function(user, callback) {\n  this.trace( \"Succeeded\", \"***\" );\n  this.executionResult.user= user;\n  this.executionResult.authenticated= true;\n  this._halt(callback);\n};\n\nAuthExecutionScope.prototype._halt= function(callback) {\n  this.executionResult.halted= true;\n  // We don't set a value for this.executionResult.authenticated\n  // as it has either been set as a result of a call to fail/redirect/success or\n  // is using the default value of 'false'\n  callback();\n};\n\nAuthExecutionScope.prototype.halt= function(callback) {\n  this.trace( \"Halted\", \"***\" );\n  this.executionResult.authenticated= undefined;\n  this._halt(callback);\n};\nAuthExecutionScope.prototype.pass= function (callback) {\n  this.trace( \"Skipped\", \"***\" );\n  callback();\n};"]],"start1":0,"start2":0,"length1":0,"length2":1916}]],"length":1916}
{"contributors":[],"silentsave":false,"ts":1352492098939,"patch":[[{"diffs":[[0,";\n  }\n  "],[1,"//"],[0,"this._tr"]],"start1":646,"start2":646,"length1":16,"length2":18}]],"length":1918,"saved":false}
{"contributors":[],"silentsave":false,"ts":1352492431574,"patch":[[{"diffs":[[0,";\n  }\n  "],[-1,"//"],[0,"this._tr"]],"start1":646,"start2":646,"length1":18,"length2":16}]],"length":1916,"saved":false}
